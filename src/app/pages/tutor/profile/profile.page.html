<ion-content>
  <!-- 1. Profile Header -->
  <div class="profile-header">
    <div class="profile-photo-container">
      <div class="profile-photo">
        <img *ngIf="profile.photoURL" [src]="profile.photoURL" alt="Profile Photo" />
        <ion-icon *ngIf="!profile.photoURL" name="person" class="default-avatar"></ion-icon>
      </div>
      <ion-button class="change-photo-btn" fill="clear" (click)="changePhoto()">
        <ion-icon slot="start" name="camera"></ion-icon>
        Change Photo
      </ion-button>
    </div>
    
    <div class="profile-info">
      <h2 class="profile-name">{{ profile.fullName }}</h2>
      <p class="profile-role">{{ profile.specialization || 'Professional Tutor' }}</p>
      <p class="profile-bio-preview" *ngIf="profile.bio">{{ profile.bio }}</p>
    </div>
  </div>

  <!-- 2. Edit Personal Information Section -->
  <div class="section-card">
    <div class="section-header">
      <h3>Personal Information</h3>
      <ion-button *ngIf="!isEditMode" fill="clear" size="small" (click)="toggleEditMode()">
        <ion-icon slot="start" name="create"></ion-icon>
        Edit Info
      </ion-button>
    </div>

    <div class="info-content" *ngIf="!isEditMode">
      <div class="info-item">
        <ion-icon name="person-circle" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Full Name</label>
          <p>{{ profile.fullName }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="at" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Username</label>
          <p>{{ profile.username }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="mail" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Email Address</label>
          <p>{{ profile.email }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="call" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Mobile Number</label>
          <p>{{ profile.mobileNumber }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="male-female" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Gender</label>
          <p>{{ profile.gender }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="calendar" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Birthday</label>
          <p>{{ profile.birthday }}</p>
        </div>
      </div>

      <div class="info-item">
        <ion-icon name="location" class="info-icon"></ion-icon>
        <div class="info-details">
          <label>Address</label>
          <p>{{ profile.address }}, {{ profile.city }}, {{ profile.province }}</p>
        </div>
      </div>
    </div>

    <!-- Edit Mode -->
    <div class="edit-form" *ngIf="isEditMode">
      <ion-item>
        <ion-label position="stacked">Full Name</ion-label>
        <ion-input [(ngModel)]="editedProfile.fullName" placeholder="Enter full name"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Username</ion-label>
        <ion-input [(ngModel)]="editedProfile.username" placeholder="Enter username"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Email Address</ion-label>
        <ion-input [(ngModel)]="editedProfile.email" type="email" placeholder="Enter email"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Mobile Number</ion-label>
        <ion-input [(ngModel)]="editedProfile.mobileNumber" type="tel" placeholder="Enter mobile number"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Gender</ion-label>
        <ion-select [(ngModel)]="editedProfile.gender" placeholder="Select gender">
          <ion-select-option *ngFor="let gender of genderOptions" [value]="gender">{{ gender }}</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Birthday</ion-label>
        <ion-input [(ngModel)]="editedProfile.birthday" type="date" placeholder="Select birthday"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Address</ion-label>
        <ion-input [(ngModel)]="editedProfile.address" placeholder="Enter street address"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">City</ion-label>
        <ion-input [(ngModel)]="editedProfile.city" placeholder="Enter city"></ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Province</ion-label>
        <ion-input [(ngModel)]="editedProfile.province" placeholder="Enter province"></ion-input>
      </ion-item>

      <div class="edit-actions">
        <ion-button expand="block" color="medium" fill="outline" (click)="cancelEdit()">
          Cancel
        </ion-button>
        <ion-button expand="block" color="primary" (click)="savePersonalInfo()">
          Save Changes
        </ion-button>
      </div>
    </div>
  </div>

  <!-- 3. About Me Section -->
  <div class="section-card">
    <div class="section-header">
      <h3>About Me</h3>
      <ion-button *ngIf="!isEditingBio" fill="clear" size="small" (click)="toggleEditBio()">
        <ion-icon slot="start" name="create"></ion-icon>
        Edit Bio
      </ion-button>
    </div>

    <div class="bio-content" *ngIf="!isEditingBio">
      <div class="bio-section">
        <label>Professional Bio</label>
        <p class="bio-text">{{ profile.bio || 'No bio added yet. Click Edit Bio to add one.' }}</p>
      </div>

      <div class="bio-section">
        <label>Specialization</label>
        <p class="bio-text">{{ profile.specialization || 'Not specified' }}</p>
      </div>

      <div class="bio-section">
        <label>Education</label>
        <p class="bio-text">{{ profile.education || 'No education information added yet.' }}</p>
      </div>
    </div>

    <!-- Edit Bio Mode -->
    <div class="edit-bio-form" *ngIf="isEditingBio">
      <ion-item>
        <ion-label position="stacked">Professional Bio (About yourself as a tutor)</ion-label>
        <ion-textarea 
          [(ngModel)]="editedBio" 
          rows="5" 
          placeholder="Tell students about your teaching background and approach..."
          maxlength="500">
        </ion-textarea>
      </ion-item>
      <p class="char-count">{{ editedBio.length }}/500 characters</p>

      <ion-item>
        <ion-label position="stacked">Specialization/Title</ion-label>
        <ion-input 
          [(ngModel)]="editedSpecialization" 
          placeholder="e.g., Mathematics Teacher, English Tutor">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Education & Qualifications</ion-label>
        <ion-textarea 
          [(ngModel)]="editedEducation" 
          rows="3" 
          placeholder="e.g., BS Mathematics, University of Manila">
        </ion-textarea>
      </ion-item>

      <div class="edit-actions">
        <ion-button expand="block" color="medium" fill="outline" (click)="cancelEditBio()">
          Cancel
        </ion-button>
        <ion-button expand="block" color="primary" (click)="saveBio()">
          Save Bio
        </ion-button>
      </div>
    </div>
  </div>

  <!-- 4. Experience & Teaching Section -->
  <div class="section-card">
    <div class="section-header">
      <h3>Experience & Teaching Style</h3>
      <ion-button *ngIf="!isEditingExperience" fill="clear" size="small" (click)="toggleEditExperience()">
        <ion-icon slot="start" name="create"></ion-icon>
        Edit
      </ion-button>
    </div>

    <div class="experience-content" *ngIf="!isEditingExperience">
      <div class="exp-item">
        <ion-icon name="time-outline" class="exp-icon"></ion-icon>
        <div class="exp-details">
          <label>Years of Experience</label>
          <p>{{ profile.experienceYears || 0 }} years</p>
        </div>
      </div>

      <div class="exp-item">
        <ion-icon name="briefcase-outline" class="exp-icon"></ion-icon>
        <div class="exp-details">
          <label>Teaching Experience</label>
          <p>{{ profile.experienceDescription || 'No experience description added yet.' }}</p>
        </div>
      </div>

      <div class="exp-item">
        <ion-icon name="bulb-outline" class="exp-icon"></ion-icon>
        <div class="exp-details">
          <label>Teaching Style</label>
          <p>{{ profile.teachingStyle || 'No teaching style description added yet.' }}</p>
        </div>
      </div>
    </div>

    <!-- Edit Experience Mode -->
    <div class="edit-experience-form" *ngIf="isEditingExperience">
      <ion-item>
        <ion-label position="stacked">Years of Experience</ion-label>
        <ion-input 
          [(ngModel)]="editedExperienceYears" 
          type="number" 
          placeholder="e.g., 5">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Teaching Experience Description</ion-label>
        <ion-textarea 
          [(ngModel)]="editedExperienceDescription" 
          rows="4" 
          placeholder="Describe your teaching background, institutions, and achievements...">
        </ion-textarea>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Teaching Style & Methodology</ion-label>
        <ion-textarea 
          [(ngModel)]="editedTeachingStyle" 
          rows="4" 
          placeholder="Describe your teaching approach, methods, and how you engage students...">
        </ion-textarea>
      </ion-item>

      <div class="edit-actions">
        <ion-button expand="block" color="medium" fill="outline" (click)="cancelEditExperience()">
          Cancel
        </ion-button>
        <ion-button expand="block" color="primary" (click)="saveExperience()">
          Save Experience
        </ion-button>
      </div>
    </div>
  </div>

  <!-- 5. Subjects & Preferences Section -->
  <div class="section-card">
    <div class="section-header">
      <h3>Subjects & Preferences</h3>
      <ion-button *ngIf="!isEditingSubjects" fill="clear" size="small" (click)="toggleEditSubjects()">
        <ion-icon slot="start" name="create"></ion-icon>
        Edit
      </ion-button>
    </div>

    <div class="subjects-content" *ngIf="!isEditingSubjects">
      <div class="subj-item">
        <ion-icon name="book-outline" class="subj-icon"></ion-icon>
        <div class="subj-details">
          <label>Subjects Taught</label>
          <div class="subject-tags">
            <span class="subject-tag" *ngFor="let subject of profile.subjectsTaught">{{ subject }}</span>
            <span *ngIf="!profile.subjectsTaught || profile.subjectsTaught.length === 0" class="no-data">No subjects added</span>
          </div>
        </div>
      </div>

      <div class="subj-item">
        <ion-icon name="cash-outline" class="subj-icon"></ion-icon>
        <div class="subj-details">
          <label>Hourly Rate</label>
          <p>₱{{ profile.hourlyRate || 0 }} per hour</p>
        </div>
      </div>

      <div class="subj-item">
        <ion-icon name="globe-outline" class="subj-icon"></ion-icon>
        <div class="subj-details">
          <label>Preferred Mode</label>
          <p>{{ profile.preferences?.preferredMode || 'Both' }}</p>
        </div>
      </div>

      <div class="subj-item">
        <ion-icon name="time-outline" class="subj-icon"></ion-icon>
        <div class="subj-details">
          <label>Available Schedule</label>
          <div class="schedule-tags">
            <span class="schedule-tag" *ngFor="let schedule of profile.preferences?.availableSchedule">{{ schedule }}</span>
            <span *ngIf="!profile.preferences?.availableSchedule || profile.preferences?.availableSchedule?.length === 0" class="no-data">No schedule set</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Subjects Mode -->
    <div class="edit-subjects-form" *ngIf="isEditingSubjects">
      <ion-item>
        <ion-label position="stacked">Subjects Taught</ion-label>
        <ion-select [(ngModel)]="editedSubjects" multiple="true" placeholder="Select subjects you teach">
          <ion-select-option value="Mathematics">Mathematics</ion-select-option>
          <ion-select-option value="English">English</ion-select-option>
          <ion-select-option value="Science">Science</ion-select-option>
          <ion-select-option value="Filipino">Filipino</ion-select-option>
          <ion-select-option value="History">History</ion-select-option>
          <ion-select-option value="Physics">Physics</ion-select-option>
          <ion-select-option value="Chemistry">Chemistry</ion-select-option>
          <ion-select-option value="Biology">Biology</ion-select-option>
          <ion-select-option value="Computer Science">Computer Science</ion-select-option>
          <ion-select-option value="Accounting">Accounting</ion-select-option>
          <ion-select-option value="Economics">Economics</ion-select-option>
          <ion-select-option value="Music">Music</ion-select-option>
          <ion-select-option value="Art">Art</ion-select-option>
          <ion-select-option value="Other">Other (specify below)</ion-select-option>
        </ion-select>
      </ion-item>

      <!-- Show text input if "Other" is selected -->
      <ion-item *ngIf="hasOtherSubject()">
        <ion-label position="stacked">Other Subject(s) - separate with commas</ion-label>
        <ion-input 
          [(ngModel)]="otherSubjects" 
          placeholder="e.g., Photography, Guitar, Japanese Language"
          (ionChange)="updateOtherSubjects()">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Hourly Rate (₱)</ion-label>
        <ion-input 
          [(ngModel)]="editedHourlyRate" 
          type="number" 
          placeholder="e.g., 500">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Preferred Mode</ion-label>
        <ion-select [(ngModel)]="editedPreferredMode" placeholder="Select teaching mode">
          <ion-select-option *ngFor="let mode of modeOptions" [value]="mode">{{ mode }}</ion-select-option>
        </ion-select>
      </ion-item>

      <div class="schedule-selector">
        <label>Available Schedule</label>
        <div class="schedule-chips">
          <ion-chip 
            *ngFor="let schedule of scheduleOptions" 
            [color]="isScheduleSelected(schedule) ? 'primary' : 'medium'"
            (click)="toggleSchedule(schedule)">
            <ion-icon [name]="isScheduleSelected(schedule) ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
            <ion-label>{{ schedule }}</ion-label>
          </ion-chip>
        </div>
      </div>

      <div class="edit-actions">
        <ion-button expand="block" color="medium" fill="outline" (click)="cancelEditSubjects()">
          Cancel
        </ion-button>
        <ion-button expand="block" color="primary" (click)="saveSubjects()">
          Save Subjects
        </ion-button>
      </div>
    </div>
  </div>

  <!-- 6. Account Management Section -->
  <div class="section-card">
    <div class="section-header">
      <h3>Account Management</h3>
    </div>

    <div class="account-management-content">
      <div class="management-item" (click)="onChangePassword()">
        <div class="management-left">
          <ion-icon name="key" class="management-icon"></ion-icon>
          <div class="management-details">
            <h4>Change Password</h4>
            <p>Update your account password</p>
          </div>
        </div>
        <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
      </div>

      <div class="management-item" (click)="onAccountSecurity()">
        <div class="management-left">
          <ion-icon name="shield-checkmark" class="management-icon"></ion-icon>
          <div class="management-details">
            <h4>Account Security</h4>
            <p>Two-factor authentication & login activity</p>
          </div>
        </div>
        <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
      </div>

      <div class="management-item" (click)="onNotificationSettings()">
        <div class="management-left">
          <ion-icon name="notifications" class="management-icon"></ion-icon>
          <div class="management-details">
            <h4>Notification Settings</h4>
            <p>Manage push notifications & email alerts</p>
          </div>
        </div>
        <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
      </div>

      <div class="management-item" (click)="onPrivacySettings()">
        <div class="management-left">
          <ion-icon name="lock-closed" class="management-icon"></ion-icon>
          <div class="management-details">
            <h4>Privacy Settings</h4>
            <p>Control your data & visibility</p>
          </div>
        </div>
        <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
      </div>
    </div>
  </div>

  <!-- Bottom Spacing -->
  <div style="height: 80px;"></div>
</ion-content>

<!-- Bottom Tab Navigation -->
<ion-footer>
  <ion-toolbar class="bottom-tabs">
    <div class="tab-buttons">
      <div class="tab-item" (click)="onTabHome()">
        <div class="tab-icon-wrapper">
          <ion-icon name="home-outline"></ion-icon>
        </div>
        <span>Home</span>
      </div>
      <div class="tab-item" (click)="onTabFindStudents()">
        <div class="tab-icon-wrapper">
          <ion-icon name="search-outline"></ion-icon>
        </div>
        <span>Find Students</span>
      </div>
      <div class="tab-item" (click)="onTabMessages()">
        <div class="tab-icon-wrapper">
          <ion-icon name="chatbubbles-outline"></ion-icon>
          <ion-badge color="danger" class="message-badge">2</ion-badge>
        </div>
        <span>Messages</span>
      </div>
      <div class="tab-item active">
        <div class="tab-icon-wrapper">
          <ion-icon name="person"></ion-icon>
        </div>
        <span>Profile</span>
      </div>
    </div>
  </ion-toolbar>
</ion-footer>
