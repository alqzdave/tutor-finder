<ion-content [fullscreen]="true" class="tutor-dashboard-content">
  <div class="dashboard-container" *ngIf="profile">
    
    <!-- Header Section -->
    <div class="dashboard-header">
      <div class="logo-container">
        <ion-icon name="school-outline" class="logo-icon"></ion-icon>
        <span class="app-name">Finding Tutor</span>
      </div>
      <div class="header-actions">
        <ion-button fill="clear" class="notification-btn">
          <ion-icon name="notifications-outline"></ion-icon>
          <ion-badge color="danger" class="notification-badge">3</ion-badge>
        </ion-button>
        <ion-button fill="clear" class="theme-toggle-btn" (click)="toggleTheme()">
          <ion-icon [name]="isDarkMode ? 'sunny-outline' : 'moon-outline'"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- Announcement Banner -->
    <div class="announcement-banner">
      <ion-icon name="megaphone-outline"></ion-icon>
      <div class="announcement-content">
        <p class="announcement-title">Welcome back, {{ profile.firstName }} ðŸ‘‹</p>
        <p class="announcement-text">Let's help students learn today!</p>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="action-card" (click)="findStudents()">
        <div class="action-icon-wrapper primary-gradient">
          <ion-icon name="search"></ion-icon>
        </div>
        <span>Find Students</span>
      </div>

      <div class="action-card" (click)="openMessages()">
        <div class="action-icon-wrapper messages-gradient">
          <ion-icon name="chatbubbles"></ion-icon>
        </div>
        <span>Messages</span>
      </div>

      <div class="action-card" (click)="viewBookings()">
        <div class="action-icon-wrapper bookings-gradient">
          <ion-icon name="calendar"></ion-icon>
        </div>
        <span>My Bookings</span>
      </div>

      <div class="action-card" (click)="editProfile()">
        <div class="action-icon-wrapper profile-gradient">
          <ion-icon name="person"></ion-icon>
        </div>
        <span>My Profile</span>
      </div>

      <div class="action-card" (click)="onLogout()">
        <div class="action-icon-wrapper logout-gradient">
          <ion-icon name="log-out"></ion-icon>
        </div>
        <span>Logout</span>
      </div>
    </div>

    <!-- Upcoming Sessions Card -->
    <div class="section-card">
      <div class="section-header">
        <h2>Upcoming Sessions</h2>
        <ion-button fill="clear" size="small" (click)="viewAllSessions()">
          <span>View All</span>
          <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
        </ion-button>
      </div>

      <div class="sessions-list" *ngIf="upcomingSessions.length > 0">
        <div class="session-card" *ngFor="let session of upcomingSessions" (click)="viewSessionDetails(session)">
          <div class="session-avatar">
            <img *ngIf="session.studentAvatar" [src]="session.studentAvatar" [alt]="session.studentName">
            <ion-icon *ngIf="!session.studentAvatar" name="person-circle-outline"></ion-icon>
          </div>
          <div class="session-info">
            <h3>{{ session.studentName }}</h3>
            <p class="session-subject">
              <ion-icon name="book-outline"></ion-icon>
              {{ session.subject }}
            </p>
            <p class="session-time">
              <ion-icon name="time-outline"></ion-icon>
              {{ session.date }} at {{ session.time }}
            </p>
          </div>
          <div class="session-status">
            <ion-badge [color]="getStatusColor(session.status)">{{ session.status }}</ion-badge>
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="upcomingSessions.length === 0">
        <ion-icon name="calendar-outline"></ion-icon>
        <p>You have no upcoming sessions â€” check student requests!</p>
        <ion-button fill="clear" (click)="findStudents()">
          Browse Student Requests
          <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
        </ion-button>
      </div>
    </div>

    <!-- Student Request Feed -->
    <div class="section-card">
      <div class="section-header">
        <h2>Student Requests</h2>
        <ion-button fill="clear" size="small" (click)="viewAllRequests()">
          <span>View All</span>
          <ion-icon slot="end" name="chevron-forward-outline"></ion-icon>
        </ion-button>
      </div>

      <div class="requests-list" *ngIf="studentRequests.length > 0">
        <div class="request-card" *ngFor="let request of studentRequests">
          <div class="request-header">
            <div class="student-info">
              <ion-icon name="person-circle-outline" class="student-icon"></ion-icon>
              <div>
                <h3>{{ request.studentName }}</h3>
                <p class="request-time">{{ request.postedTime }}</p>
              </div>
            </div>
            <ion-badge [color]="getModeColor(request.mode)">{{ request.mode }}</ion-badge>
          </div>

          <div class="request-details">
            <div class="detail-item">
              <ion-icon name="book-outline"></ion-icon>
              <span><strong>Subject:</strong> {{ request.subject }}</span>
            </div>
            <div class="detail-item">
              <ion-icon name="calendar-outline"></ion-icon>
              <span><strong>Schedule:</strong> {{ request.schedule }}</span>
            </div>
            <div class="detail-item" *ngIf="request.location">
              <ion-icon name="location-outline"></ion-icon>
              <span><strong>Location:</strong> {{ request.location }}</span>
            </div>
            <div class="detail-item" *ngIf="request.specialInstructions">
              <ion-icon name="document-text-outline"></ion-icon>
              <span><strong>Notes:</strong> {{ request.specialInstructions }}</span>
            </div>
          </div>

          <div class="request-actions">
            <ion-button fill="outline" size="small" (click)="viewRequestDetails(request)">
              <ion-icon slot="start" name="eye-outline"></ion-icon>
              View Details
            </ion-button>
            <ion-button size="small" (click)="sendOffer(request)">
              <ion-icon slot="start" name="send-outline"></ion-icon>
              Send Offer
            </ion-button>
          </div>
        </div>
      </div>

      <div class="empty-state" *ngIf="studentRequests.length === 0">
        <ion-icon name="search-outline"></ion-icon>
        <p>No student requests available at the moment.</p>
        <ion-button fill="clear" (click)="findStudents()">
          Refresh Requests
          <ion-icon slot="end" name="refresh-outline"></ion-icon>
        </ion-button>
      </div>
    </div>



  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="!profile">
    <ion-spinner color="primary"></ion-spinner>
    <p>Loading dashboard...</p>
  </div>
</ion-content>

<!-- Bottom Tab Navigation -->
<ion-footer class="bottom-tabs">
  <ion-toolbar>
    <div class="tab-buttons">
      <div class="tab-item active">
        <div class="tab-icon-wrapper">
          <ion-icon name="home"></ion-icon>
        </div>
        <span>Home</span>
      </div>
      <div class="tab-item" (click)="findStudents()">
        <div class="tab-icon-wrapper">
          <ion-icon name="search-outline"></ion-icon>
        </div>
        <span>Find Students</span>
      </div>
      <div class="tab-item" (click)="openMessages()">
        <div class="tab-icon-wrapper">
          <ion-icon name="chatbubbles-outline"></ion-icon>
          <ion-badge color="danger" class="message-badge">2</ion-badge>
        </div>
        <span>Messages</span>
      </div>
      <div class="tab-item" (click)="editProfile()">
        <div class="tab-icon-wrapper">
          <ion-icon name="person-outline"></ion-icon>
        </div>
        <span>Profile</span>
      </div>
    </div>
  </ion-toolbar>
</ion-footer>
